<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Rubik:ital,wght@0,300..900;1,300..900&display=swap"
      rel="stylesheet"
    />
    <title>Checkout</title>
    <style>
      /* All the previous CSS styles remain the same */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Montserrat", sans-serif;
      }

      body {
        background-color: #f5f5f5;
        color: #333;
        line-height: 1.6;
      }

      .container {
        display: flex;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        gap: 30px;
      }

      .checkout-form {
        flex: 1;
        background: white;
        padding: 30px;
        border-radius: 8px;
      }

      .order-summary {
        width: 400px;
        background: white;
        padding: 30px;
        border-radius: 8px;
        height: fit-content;
      }

      .section {
        margin-bottom: 30px;
      }

      h2 {
        font-size: 24px;
        margin-bottom: 20px;
      }

      .form-group {
        margin-bottom: 15px;
      }

      input[type="text"],
      input[type="email"],
      select {
        width: 100%;
        padding: 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-top: 5px;
      }

      .name-group {
        display: flex;
        gap: 15px;
      }

      .name-group .form-group {
        flex: 1;
      }

      .checkbox-group {
        display: flex;
        align-items: center;
        gap: 10px;
        margin: 15px 0;
      }

      .shipping-option {
        border: 1px solid #ddd;
        padding: 15px;
        border-radius: 4px;
        margin-bottom: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        cursor: pointer;
      }

      .shipping-option.selected {
        border-color: #f60;
        background-color: #f5f9ff;
      }

      .cart-item {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
        padding-bottom: 20px;
        border-bottom: 1px solid #eee;
      }

      .cart-item h3 {
        font-size: 1rem;
        font-weight: 500;
        line-height: 1.3;
        min-width: 190px;
      }
      .cart-item img {
        width: 80px;
        height: 80px;
        object-fit: cover;
        border-radius: 4px;
      }

      .price-row {
        display: flex;
        justify-content: space-between;
        margin: 10px 0;
      }

      .total-row {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid #eee;
        font-weight: bold;
        font-size: 18px;
      }

      .discount-input {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
      }

      .discount-input input {
        flex: 1;
      }

      button[type="submit"] {
        background: #f60;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        width: 100%;
      }

      button[type="submit"]:hover {
        background: rgb(232, 94, 1);
      }

      .apply-btn {
        width: auto;
        white-space: nowrap;
        padding: 12px;
        background-color: #f60;
        border-radius: 5px;
        border: none;
        color: #fff;
        cursor: pointer;
      }

      .log-in {
        float: right;
        color: #4a90e2;
        text-decoration: none;
      }

      .log-in:hover {
        text-decoration: underline;
      }
      .price {
        justify-self: flex-end;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <form action="/process-checkout" method="POST" class="checkout-form">
        <div class="section">
          <h2>Contact</h2>
          <div class="form-group">
            <input
              type="email"
              name="email"
              placeholder="Email"
              value="<%=email%>"
              required
              disabled
            />
          </div>
          <div class="checkbox-group">
            <input type="checkbox" id="newsletter" name="newsletter" />
            <label for="newsletter">Email me with news and offers</label>
          </div>
        </div>

        <div class="section">
          <h2>Delivery</h2>
          <div class="form-group">
            <select id="country" name="country" required>
              <option value="pakistan">Pakistan</option>
            </select>
          </div>
          <div class="name-group">
            <div class="form-group">
              <input
                type="text"
                name="firstName"
                placeholder="First name "
                required
              />
            </div>
            <div class="form-group">
              <input
                type="text"
                name="lastName"
                placeholder="Last name"
                required
              />
            </div>
          </div>
          <div class="form-group">
            <input type="text" name="address" placeholder="Address" required />
          </div>
          <div class="name-group">
            <div class="form-group">
              <input type="text" name="city" placeholder="City" required />
            </div>
            <div class="form-group">
              <input
                type="text"
                name="postalCode"
                placeholder="Postal code (optional)"
              />
            </div>
          </div>
          <div class="form-group">
            <input type="text" name="phone" placeholder="Phone" required />
          </div>
          <div class="checkbox-group">
            <input type="checkbox" id="save-info" name="saveInfo" />
            <label for="save-info">Save this information for next time</label>
          </div>
        </div>

        <div class="section">
          <h2>Payment</h2>
          <p>All transactions are secure and encrypted.</p>
          <div class="shipping-option selected">
            <div>
              <input
                type="radio"
                name="paymentMethod"
                id="COD"
                value="COD"
                checked
                required
              />
              <label for="cod">Cash on Delivery (COD)</label>
            </div>
          </div>
          <div class="shipping-option">
            <div>
              <input
                type="radio"
                name="paymentMethod"
                id="Card"
                value="Card"
                required
              />
              <label for="card">Online Payment</label>
            </div>
          </div>
        </div>

        <div class="section">
          <h2>Billing address</h2>
          <div class="shipping-option selected">
            <div>
              <input
                type="radio"
                name="billingAddress"
                id="same"
                value="same"
                checked
                required
              />
              <label for="same">Same as shipping address</label>
            </div>
          </div>
          <div class="shipping-option">
            <div>
              <input
                type="radio"
                name="billingAddress"
                id="different"
                value="different"
                required
              />
              <label for="different">Use a different billing address</label>
            </div>
          </div>
        </div>
        
        <input type="hidden" name="subtotal" value="<%=totalPrice%>" />
        <input type="hidden" name="shipping" value="<%=shipping%>" />
        <input type="hidden" name="total" value="<%=totalPriceWithShipping%>" />
        <button type="submit">Complete order</button>
      </form>

      <div class="order-summary">
        <% cart.forEach(item => { %>
        <div class="cart-item">
          <img src="<%= item.image[0] %>" alt="<%= item.name %>" />
          <div>
            <h3><%= item.name %></h3>
            <p>Quantity x <%= item.quantity %></p>
          </div>
          <div class="price">$<%= item.price.toFixed(2) %></div>
        </div>
        <% }); %>

        <div class="discount-input">
          <input type="text" placeholder="Discount code or gift card" />
          <button type="button" class="apply-btn">Apply</button>
        </div>

        <div class="price-row">
          <span>Subtotal</span>
          <span><%=totalPrice%></span>
        </div>
        <div class="price-row">
          <span>Shipping</span>
          <span><%=shipping%></span>
        </div>

        <div class="total-row">
          <span>Total</span>
          <div>
            <small>$</small>
            <span><%=totalPriceWithShipping %></span>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Handle shipping option selection
      document.querySelectorAll(".shipping-option").forEach((option) => {
        option.addEventListener("click", function () {
          const radioInput = this.querySelector('input[type="radio"]');
          if (radioInput) {
            radioInput.checked = true;

            // Remove selected class from all options in the same group
            const name = radioInput.name;
            document
              .querySelectorAll(`input[name="${name}"]`)
              .forEach((input) => {
                input.closest(".shipping-option").classList.remove("selected");
              });

            // Add selected class to clicked option
            this.classList.add("selected");
          }
        });
      });
    </script>
  </body>
</html>
